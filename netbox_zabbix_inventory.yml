plugin: netbox.netbox.nb_inventory
validate_certs: false
config_context: true
flatten_custom_fields: true

compose:
  ansible_network_os: "platform.slug | default(platform.name, true) | default('unknown') | lower"
  ansible_host: "primary_ip.address.split('/')[0] | default('0.0.0.0')"
  site_id: "site.id"
  site_slug: "site.slug"
  site_name: "site.name"
  device_role_slug: "device_role.slug"
  device_role: "device_role.name"
  tags: "tags | map(attribute='name') | list"
  description: "description"
  sla_report_code: "custom_fields.sla_report_code | default('')"
  zabbix_template: "custom_fields.zabbix_template_name | default('')"
  environment: "custom_fields.environment | default('')"

device_query_filters:
  - "status=active&has_primary_ip=true&cf_mon_required=true&platform_id__isnull=false&cf_zabbix_template_name__isnull=false&cf_zabbix_template_name__empty=false&cf_sla_report_code__isnull=false&cf_sla_report_code__empty=false&cf_environment__isnull=false&cf_environment__empty=false"

vm_query_filters:
  - "status=active&has_primary_ip=true&cf_mon_required=true&platform_id__isnull=false&cf_zabbix_template_name__isnull=false&cf_zabbix_template_name__empty=false&cf_sla_report_code__isnull=false&cf_sla_report_code__empty=false&cf_environment__isnull=false&cf_environment__empty=false"

group_by:
  - sites
  - device_roles
  - platforms
